(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{34:function(e,t,n){e.exports=n(71)},71:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),u=n(27),o=n.n(u),c=n(1),s=n.n(c),i=n(2),l=n(28),p=n(6),f=n(7),b=n(10),d=n(8),v=n(11),m=n(4),h=n.n(m),g="/api/blogs",O=null,w=function(){var e=Object(i.a)(s.a.mark(function e(){var t;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.get(g);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),E=function(){var e=Object(i.a)(s.a.mark(function e(t){var n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.get("".concat(g,"/").concat(t));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),y={getAll:w,setToken:function(e){var t="bearer ".concat(e);O={headers:{Authorization:t,"Content-Type":"application/json"}}},create:function(){var e=Object(i.a)(s.a.mark(function e(t){var n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.post(g,t,O);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),getOne:E,update:function(){var e=Object(i.a)(s.a.mark(function e(t,n){var r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.put("".concat(g,"/").concat(t),n,O);case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),remove:function(){var e=Object(i.a)(s.a.mark(function e(t){var n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.delete("".concat(g,"/").concat(t),O);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},j=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(b.a)(this,Object(d.a)(t).call(this,e))).toggleVisibility=function(){n.setState({visible:!n.state.visible})},n.addLike=function(){var e=Object(i.a)(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.preventDefault(),e.next=4,y.update(n.props.blog._id,{title:n.props.blog.title,author:n.props.blog.author,url:n.props.blog.url,user:n.props.blog.user,likes:n.props.blog.likes+1});case 4:e.sent,n.forceUpdate(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:setTimeout(function(){n.setState({error:null})},3e3);case 12:case"end":return e.stop()}},e,null,[[0,8]])}));return function(t){return e.apply(this,arguments)}}(),n.deleteBlog=function(){var e=Object(i.a)(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.preventDefault(),e.next=4,y.remove(n.props.blog._id);case 4:e.sent,n.forceUpdate(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0+"delete blog error");case 11:case"end":return e.stop()}},e,null,[[0,8]])}));return function(t){return e.apply(this,arguments)}}(),n.state={visible:!1},n}return Object(v.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this,t={display:this.state.visible?"":"none"};return a.a.createElement("div",{style:{paddingTop:10,paddingLeft:2,border:"solid",borderWidth:1,marginBottom:5},className:"everything"},a.a.createElement("div",{className:"authorAndTitle",onClick:this.toggleVisibility},this.props.blog.title," ",this.props.blog.author),a.a.createElement("div",{className:"togglableContent",style:t},a.a.createElement("a",{href:this.props.blog.url},this.props.blog.url),a.a.createElement("p",null,this.props.blog.likes," likes ",a.a.createElement("button",{onClick:this.addLike},"like")),a.a.createElement("p",null,"added by ",this.props.blog.user.name),a.a.createElement(function(){return console.log(e.props.user.username),console.log(e.props.blog.user.username),e.props.user.username!==e.props.blog.user.username&&e.props.blog.user.username?a.a.createElement("div",null,"You can only delete your own blogs"):a.a.createElement("div",null,a.a.createElement("button",{onClick:e.deleteBlog},"delete"))},null)))}}]),t}(a.a.Component),k={login:function(){var e=Object(i.a)(s.a.mark(function e(t){var n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},x=n(9),S=function(e){function t(){return Object(p.a)(this,t),Object(b.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(v.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return this.props.notification.message?a.a.createElement("div",{className:"notification"},this.props.notification.message):null}}]),t}(a.a.Component),N=Object(x.b)(function(e){return{notification:e.notification}},null)(S),C=n(16),I=n(14),T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"NEW_BLOG":return[].concat(Object(I.a)(e),[t.blog]);case"INIT_BLOGS":return t.blogs;default:return e}},_=function(e){return{type:"NEW_NOTIFICATION",notification:e}},A=function(e){return function(){var t=Object(i.a)(s.a.mark(function t(n){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n(_(e)),setTimeout(function(){n({type:"CLEAR_NOTIFICATION"})},3e3);case 2:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"NEW_NOTIFICATION":return t.notification;case"CLEAR_NOTIFICATION":return{};default:return e}},U=void 0,L=Object(x.b)(null,{createNewBlog:function(e){return function(){var t=Object(i.a)(s.a.mark(function t(n){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,y.create(e);case 2:r=t.sent,n({type:"NEW_NOTE",blog:r});case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},createNotification:A})(function(e){var t=Object(r.useState)(""),n=Object(C.a)(t,2),u=n[0],o=n[1],c=Object(r.useState)(""),l=Object(C.a)(c,2),p=l[0],f=l[1],b=Object(r.useState)(""),d=Object(C.a)(b,2),v=d[0],m=d[1],h=function(){var e=Object(i.a)(s.a.mark(function e(t){var n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:try{t.preventDefault(),n={title:U.state.title,author:U.state.author,url:U.state.url},U.props.createNewBlog(n),U.props.createNotification({message:"A new blog ".concat(U.state.title," by ").concat(U.state.author," added")}),U.setState({title:"",author:"",url:""})}catch(r){U.setState({error:"couldn't add new blog due to an error: ".concat(r)}),setTimeout(function(){U.setState({error:null})},3e3)}case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();return a.a.createElement("div",null,a.a.createElement("h2",null,"Kirjaudu"),a.a.createElement("form",{onSubmit:h},a.a.createElement("div",null,"title",a.a.createElement("input",{type:"text",name:"title",value:p,onChange:function(e){var t=e.target;return f(t.value)}})),a.a.createElement("div",null,"author",a.a.createElement("input",{type:"text",name:"author",value:u,onChange:function(e){var t=e.target;return o(t.value)}})),a.a.createElement("div",null,"url",a.a.createElement("input",{type:"text",name:"url",value:v,onChange:function(e){var t=e.target;return m(t.value)}})),a.a.createElement("button",null,"create")))}),W=function(e){var t=e.onSubmit;return a.a.createElement("div",null,a.a.createElement("form",{onSubmit:t},a.a.createElement("button",null,"logout")))},D=function(e){var t=e.onSubmit,n=e.username,r=e.password,u=e.handleChange;return a.a.createElement("div",null,a.a.createElement("h2",null,"Kirjaudu"),a.a.createElement("form",{onSubmit:t},a.a.createElement("div",null,"k\xe4ytt\xe4j\xe4tunnus",a.a.createElement("input",{type:"text",name:"username",value:n,onChange:u})),a.a.createElement("div",null,"salasana",a.a.createElement("input",{type:"password",name:"password",value:r,onChange:u})),a.a.createElement("button",null,"kirjaudu")))},R=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(b.a)(this,Object(d.a)(t).call(this,e))).toggleVisibility=function(){n.setState({visible:!n.state.visible})},n.state={visible:!1},n}return Object(v.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e={display:this.state.visible?"none":""},t={display:this.state.visible?"":"none"};return a.a.createElement("div",null,a.a.createElement("div",{style:e},a.a.createElement("button",{onClick:this.toggleVisibility},this.props.buttonLabel)),a.a.createElement("div",{style:t},this.props.children,a.a.createElement("button",{onClick:this.toggleVisibility},"cancel")))}}]),t}(a.a.Component),z=function(){var e=Object(i.a)(s.a.mark(function e(){var t;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.get("/api/users");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),V=function(){var e=Object(i.a)(s.a.mark(function e(t){var n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.get("".concat("/api/users","/").concat(t));case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),F={getAll:z,create:function(){var e=Object(i.a)(s.a.mark(function e(t){var n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.post("/api/users",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),getOne:V},G=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"NEW_USER":return[].concat(Object(I.a)(e),[t.user]);case"INIT_USERS":return t.users;case"GET_USER":return t.user;default:return e}},J=function(e){function t(e){var n;return Object(p.a)(this,t),(n=Object(b.a)(this,Object(d.a)(t).call(this,e))).handleChange=function(e){n.setState(Object(l.a)({},e.target.name,e.target.value))},n.logout=function(){var e=Object(i.a)(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault();try{window.localStorage.removeItem("loggedUser"),n.setState({username:"",password:"",user:null})}catch(r){console.log(r)}case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.login=function(){var e=Object(i.a)(s.a.mark(function e(t){var r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,k.login({username:n.state.username,password:n.state.password});case 4:r=e.sent,window.localStorage.setItem("loggedUser",JSON.stringify(r)),y.setToken(r.token),n.setState({username:"",password:"",user:r}),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(1),n.props.createNotification({message:"Wrong username or password"}),console.log(e.t0);case 14:case"end":return e.stop()}},e,null,[[1,10]])}));return function(t){return e.apply(this,arguments)}}(),n.state={username:"",password:"",selectedBlog:null,user:null},n}return Object(v.a)(t,e),Object(f.a)(t,[{key:"componentWillMount",value:function(){this.props.initializeUsers(),this.props.initializeBlogs()}},{key:"componentDidMount",value:function(){var e=window.localStorage.getItem("loggedUser");if(e){var t=JSON.parse(e);this.setState({user:t}),y.setToken(t.token)}}},{key:"render",value:function(){var e=this;return a.a.createElement("div",null,a.a.createElement(N,{message:this.state.notification}),null===this.state.user?a.a.createElement(D,{onSubmit:e.login,username:e.state.username,password:e.state.password,handleChange:e.handleChange}):a.a.createElement("div",null,a.a.createElement("p",null,this.state.user.name," logged in"),a.a.createElement(W,{onSubmit:e.logout}),a.a.createElement(R,{buttonLabel:"create"},a.a.createElement(L,null)),a.a.createElement("h2",null,"blogs"),this.props.blogs.map(function(t){return a.a.createElement(j,{key:t._id,blog:t,user:e.state.user})})))}}]),t}(a.a.Component),M=Object(x.b)(function(e){return{blogs:e.blogs}},{createNotification:A,initializeUsers:function(){return function(){var e=Object(i.a)(s.a.mark(function e(t){var n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F.getAll();case 2:n=e.sent,t({type:"INIT_USERS",users:n});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},initializeBlogs:function(){return function(){var e=Object(i.a)(s.a.mark(function e(t){var n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.getAll();case 2:n=e.sent,t({type:"INIT_BLOGS",blogs:n});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}})(J),K=n(12),Y=n(32),q=n.n(Y),H=n(33),P=Object(K.combineReducers)({notification:B,blogs:T,user:G}),Q=Object(K.createStore)(P,Object(H.composeWithDevTools)(Object(K.applyMiddleware)(q.a)));o.a.render(a.a.createElement(x.a,{store:Q},a.a.createElement(M,null)),document.getElementById("root"))}},[[34,1,2]]]);
//# sourceMappingURL=main.1e55add6.chunk.js.map